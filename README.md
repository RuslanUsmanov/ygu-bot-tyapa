# Бот для дискорд сервера 58281-2018

## Общее описание

Данный бот предназначен для решения широкого круга задач на сервере 58281-2018 в дискорде.  
Бот является открытой платформой и его функционал можно расширять

## Требования

- Python >= 3.8
- aiofiles==0.5.0
- discord.py==1.3.3
- jinja2==2.11.2
- loguru==0.5.1
- pony==0.7.13

## Установка

1. Выполнить в консоле  `git clone https://github.com/pyro-bot/ygu-bot-tyapa`
2. Рекомендуется создать виртуальное окружение: `python -m virtualenv .venv` и затем использовать его
   1. для Linux: `source ./.venv/binc/activate`
   2. для Windows: `.\.venv\Scripts\activate`
3. Уставновить зависимости: `pip install -r requirements.txt`
4. Создать файл `.env` (или любой другой где будут находится ваши переменные окружения) в корне проекта
   1. Добавть в него записи о перменной DEBUG и TOKEN
      1. DEBUG - 1 = включен редим разработки, 0 = отключен
      2. TOKEN = это серкетный ключ вашего бота
   2. Пример файла: <code language="bash"> <br>DEBUG=1<br>TOKEN=secret_token</code>
5. Запустить файл app.py (в корне проекта), перед этим экспортировав переменные окружения из файла `.env`


*Примечание для пользователей VSCode*  
Вы можите настроить запуск бота с автоматическим подключением файла `.env` для этого создайте папку `.vscode` в корне проекта, а в ней создайте или отредактируйте файл `launch.json`. В самом простом случае ваш файл должен выглядеть вот так
```json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Bot",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/app.py",
            "console": "integratedTerminal",
            "envFile": "${workspaceFolder}/.env"
        }
    ]
}
```
Теперь по нажатию клавиши `F5` вы запустите бота на отладку


## Как добавить свою функцию в бота

Бот основан на библиотеки discorg.py. Расширения функционала происходит за счет написания пользовательских модулей основыных на классе Cog из бибилиотеки discord.py  

Для того чтобы добавить новый функционал в бота вам надо:

1. Сделать форк бота
2. Добавить в папку modules новый модуль. (смотрите пример модуля example в папке modules)
3. Добавить в файле `settings.py` в конец массив `MODULES` название вашего модуля
4. Проверить работу вашего модуля
5. Вернуть изменения в основной репозиторий через систему pull request (Запрос на слияние)
6. Дальше ваш код проходит модерацию и если все хорошо, то будет добавлен в бота
7. Если есть проглемы вам о них сообщать в чате запроса на слияние и вы должны будуте исправить замечания

## Как отлаживать бота

На данный момент прелогается следующий способ отладки:

1. Зарегистировать нового бота в дискорде
2. Создать отдельный сервер в дискорде
3. Установить в переменных откружения нужный токен бота
4. Добавить бота на ваш сервер в дискорде